const movies = [];

exports.getAllMovies = (request, response) => {
  response.send(movies);
};

exports.createMovie = (request, response) => {
  console.log(request.body);
  const movie = request.body;
  movie.id = Date.now().toString();
  movies.push(movie);
  response.send(movie);
};

exports.getMovie = (request, response) => {
  const movieId = request.params.id;
  const movie = movies.find((movie) => movie.id === movieId);
  response.send(movie);
};

exports.updateMovie = (request, response) => {
  const index = movies.findIndex((movie) => movie.id === request.params.id);
  if (index !== -1) {
    movies[index] = { ...movies[index], ...request.body };
    response.send(movies[index]);
  }
};

exports.deleteMovie = (request, response) => {
  const movieId = request.params.id;
  const index = movies.findIndex((movie) => movie.id === movieId);

  if (index !== -1) {
    const deletedMovie = movies.splice(index, 1);
    response.send(deletedMovie[0]); // send back deleted movie
  } else {
    response.status(404).send({ error: "Movie not found" });
  }
};
